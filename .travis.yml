language: node_js
node_js:
- node
after_success:
- npm run coveralls
before_deploy:
- deployment-scripts/before-deploy.sh
- deployment-scripts/create-zip.sh
deploy:
- provider: s3
  access_key_id:
    secure: WhP68a+9hV3q24u9p5YOBJJo9iG/3fzTW4yn9Qi0Fxt4onenO7sMFFn2bcHk+rtu5Laq8vEkBXQlCOmihDh7DSYBuVuKNJXlNsbPZTEoBjgO20sEru6lqpueQAW3n05EtIrIwzpgrH6DtQYCz3A2MsxDw3kyNgv0fNUOXHfUQmiVJJtPtEWYy1PjCTS7BfAqowGu+m/TaWDZCnld2wscSj21FFKlcY52LNfQ4XCT0xFrZTx8wB0/v7wXIEXk/9m4FSt8hUxYTL17+yKqIiwwfh3S/Ro1r+IBA64+l9SvPR32OzEHOhrgVSeDXzQ6XxoD2wT0AVLnrL5kVck+Z4Ca1FGBm9Qu24JHm9jLKMB9yy7ru+Y3dkUMFqK8v04mfQOHRCdNWFNlXXu23RMVQ+CbfG0G/3MUHjDxksC2kO9HHPxjQ1dzN7runmt0w546HR+X54E3m3JjgKw4BB3AKj9hUn03GlW0slhajgb6e3YRyEmfzElATFUXPsmKuUWxlygcpW3i4NtZ0kIWVSIlol69jiViVJdAGlecxFRs00QAHUrEvHPueSPZUNHNsp8z0BahizscXtu9VCKz4oye2mo+YJcuvC0sfNFGu0Pso6kkIoNBhXn+rmR1LQ1Uqv8jQ5DzrLy5Eo2JF5i4zLeU89ThuvNkPC64p+T0eQdZhrXQxyY=
  secret_access_key:
    secure: kTJg/k2pMF709kPlbkOD/DYkI+GHE3z6unJM7H77pIfBc+rIZgwnVfNqqC//jipqp+S747NKWn1raH+GYwcEUD/jvN6/fa6mcLZ9BJJ5jlvX/EOn3vGHjfo/x7auEJkc41ifRlAiUEugF6TVcqmet2v5KGMnqSrfHSayWsbT+Q/5pmkuMruqXQUc9ck2UJGwrEGtCTBaxLiZKp6GWPLL/YEmvx4e2IQddsqWp/WssC+ak4wfKZq4K4hCnExBTg9RxhUE3yxbsnHpux+adzzmGIqP566nRAKYIeIRWr1D8Julgc76I9wqai+3nJzbHDQ8tOqatZw5Q7yECc7f3SXkO9FmpTZqL0zWMbdiu6l6rggV6DF+YTCaRaTmOKPR+bNpA+vdHzsHCiL0HecN6DYdoX7oeESAhA+cGvn60hnowSCG071PcSdLL8OrlpE0gdZZxP3KrNmKaWzmKhGcyx+FOeblvrlhbeJ2o1kUpa95q3u0xgsPDjiPaVj6/ADzpYN6aKDMzOtrGBHBkagbRvjE4jfEDskXho85Z3t9X3MGgA+3H0f7NKRD8syYQDVNcbpxmZp43Fg/9E7itvdNa42E8m/WD4gWmXFAGX/K8eWerJTLNjLKYl0A+iJpNzpBaltEsj7d9/oNSxLEyf3RDkWwyUuHHktoPwj5g2/dvr+4Sj4=
  bucket: amos-deploy-dev
  skip_cleanup: true
  region: eu-west-1
  local-dir: deployment-build
  on:
    all_branches: true
    condition: $TRAVIS_BRANCH = feature-73-npm-engine || $TRAVIS_BRANCH = master
- provider: codedeploy
  access_key_id:
    secure: WhP68a+9hV3q24u9p5YOBJJo9iG/3fzTW4yn9Qi0Fxt4onenO7sMFFn2bcHk+rtu5Laq8vEkBXQlCOmihDh7DSYBuVuKNJXlNsbPZTEoBjgO20sEru6lqpueQAW3n05EtIrIwzpgrH6DtQYCz3A2MsxDw3kyNgv0fNUOXHfUQmiVJJtPtEWYy1PjCTS7BfAqowGu+m/TaWDZCnld2wscSj21FFKlcY52LNfQ4XCT0xFrZTx8wB0/v7wXIEXk/9m4FSt8hUxYTL17+yKqIiwwfh3S/Ro1r+IBA64+l9SvPR32OzEHOhrgVSeDXzQ6XxoD2wT0AVLnrL5kVck+Z4Ca1FGBm9Qu24JHm9jLKMB9yy7ru+Y3dkUMFqK8v04mfQOHRCdNWFNlXXu23RMVQ+CbfG0G/3MUHjDxksC2kO9HHPxjQ1dzN7runmt0w546HR+X54E3m3JjgKw4BB3AKj9hUn03GlW0slhajgb6e3YRyEmfzElATFUXPsmKuUWxlygcpW3i4NtZ0kIWVSIlol69jiViVJdAGlecxFRs00QAHUrEvHPueSPZUNHNsp8z0BahizscXtu9VCKz4oye2mo+YJcuvC0sfNFGu0Pso6kkIoNBhXn+rmR1LQ1Uqv8jQ5DzrLy5Eo2JF5i4zLeU89ThuvNkPC64p+T0eQdZhrXQxyY=
  secret_access_key:
    secure: kTJg/k2pMF709kPlbkOD/DYkI+GHE3z6unJM7H77pIfBc+rIZgwnVfNqqC//jipqp+S747NKWn1raH+GYwcEUD/jvN6/fa6mcLZ9BJJ5jlvX/EOn3vGHjfo/x7auEJkc41ifRlAiUEugF6TVcqmet2v5KGMnqSrfHSayWsbT+Q/5pmkuMruqXQUc9ck2UJGwrEGtCTBaxLiZKp6GWPLL/YEmvx4e2IQddsqWp/WssC+ak4wfKZq4K4hCnExBTg9RxhUE3yxbsnHpux+adzzmGIqP566nRAKYIeIRWr1D8Julgc76I9wqai+3nJzbHDQ8tOqatZw5Q7yECc7f3SXkO9FmpTZqL0zWMbdiu6l6rggV6DF+YTCaRaTmOKPR+bNpA+vdHzsHCiL0HecN6DYdoX7oeESAhA+cGvn60hnowSCG071PcSdLL8OrlpE0gdZZxP3KrNmKaWzmKhGcyx+FOeblvrlhbeJ2o1kUpa95q3u0xgsPDjiPaVj6/ADzpYN6aKDMzOtrGBHBkagbRvjE4jfEDskXho85Z3t9X3MGgA+3H0f7NKRD8syYQDVNcbpxmZp43Fg/9E7itvdNa42E8m/WD4gWmXFAGX/K8eWerJTLNjLKYl0A+iJpNzpBaltEsj7d9/oNSxLEyf3RDkWwyUuHHktoPwj5g2/dvr+4Sj4=
  bucket: amos-deploy-dev
  key: latest.zip
  application: amos-app-dev
  deployment_group: amos-deployment-group
  region: eu-west-1
  wait-until-deployed: true
  on:
    branch: feature-73-npm-engine
- provider: codedeploy
  access_key_id:
    secure: WhP68a+9hV3q24u9p5YOBJJo9iG/3fzTW4yn9Qi0Fxt4onenO7sMFFn2bcHk+rtu5Laq8vEkBXQlCOmihDh7DSYBuVuKNJXlNsbPZTEoBjgO20sEru6lqpueQAW3n05EtIrIwzpgrH6DtQYCz3A2MsxDw3kyNgv0fNUOXHfUQmiVJJtPtEWYy1PjCTS7BfAqowGu+m/TaWDZCnld2wscSj21FFKlcY52LNfQ4XCT0xFrZTx8wB0/v7wXIEXk/9m4FSt8hUxYTL17+yKqIiwwfh3S/Ro1r+IBA64+l9SvPR32OzEHOhrgVSeDXzQ6XxoD2wT0AVLnrL5kVck+Z4Ca1FGBm9Qu24JHm9jLKMB9yy7ru+Y3dkUMFqK8v04mfQOHRCdNWFNlXXu23RMVQ+CbfG0G/3MUHjDxksC2kO9HHPxjQ1dzN7runmt0w546HR+X54E3m3JjgKw4BB3AKj9hUn03GlW0slhajgb6e3YRyEmfzElATFUXPsmKuUWxlygcpW3i4NtZ0kIWVSIlol69jiViVJdAGlecxFRs00QAHUrEvHPueSPZUNHNsp8z0BahizscXtu9VCKz4oye2mo+YJcuvC0sfNFGu0Pso6kkIoNBhXn+rmR1LQ1Uqv8jQ5DzrLy5Eo2JF5i4zLeU89ThuvNkPC64p+T0eQdZhrXQxyY=
  secret_access_key:
    secure: kTJg/k2pMF709kPlbkOD/DYkI+GHE3z6unJM7H77pIfBc+rIZgwnVfNqqC//jipqp+S747NKWn1raH+GYwcEUD/jvN6/fa6mcLZ9BJJ5jlvX/EOn3vGHjfo/x7auEJkc41ifRlAiUEugF6TVcqmet2v5KGMnqSrfHSayWsbT+Q/5pmkuMruqXQUc9ck2UJGwrEGtCTBaxLiZKp6GWPLL/YEmvx4e2IQddsqWp/WssC+ak4wfKZq4K4hCnExBTg9RxhUE3yxbsnHpux+adzzmGIqP566nRAKYIeIRWr1D8Julgc76I9wqai+3nJzbHDQ8tOqatZw5Q7yECc7f3SXkO9FmpTZqL0zWMbdiu6l6rggV6DF+YTCaRaTmOKPR+bNpA+vdHzsHCiL0HecN6DYdoX7oeESAhA+cGvn60hnowSCG071PcSdLL8OrlpE0gdZZxP3KrNmKaWzmKhGcyx+FOeblvrlhbeJ2o1kUpa95q3u0xgsPDjiPaVj6/ADzpYN6aKDMzOtrGBHBkagbRvjE4jfEDskXho85Z3t9X3MGgA+3H0f7NKRD8syYQDVNcbpxmZp43Fg/9E7itvdNa42E8m/WD4gWmXFAGX/K8eWerJTLNjLKYl0A+iJpNzpBaltEsj7d9/oNSxLEyf3RDkWwyUuHHktoPwj5g2/dvr+4Sj4=
  bucket: amos-deploy-dev
  key: latest.zip
  application: amos-app-master
  deployment_group: amos-deployment-group
  region: eu-west-1
  wait-until-deployed: true
  on:
    branch: master
